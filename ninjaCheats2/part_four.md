## JavaScript(《忍者秘籍2》) md(ninjaCheats2)

### Part Four 认知浏览器

### 4.1 DOM操作
将HTML字符串转换为DOM元素包括以下步骤。
- 确保HTML字符串是有效的HTML代码。
- 将其包装成封闭的标记，符合浏览器规则要求。
- 通过DOM元素的innerHTML属性将HTML插入虚拟DOM元素。
- 将创建的DOM节点提取出来。
- 为了快速插入DOM节点，请使用DOM片段，因为可以在单个操作中注入片段，从而大大减少了操作次数。
- DOM元素属性和特性，尽管挂钩，但并不总是相同！我们可以通过使用getAttribute和setAttribute方法读取和写入DOM属性，同时也可以使用对象属性符号方式写入DOM属性。
- 使用属性和特性时，也有必要了解自定义属性。我们在DOM元素上自定义的特性，仅用于自定义信息，不能与元素属性等同看待或使用。
- 元素style属性是一个对象，它含有与元素标记中指定的样式值相对应的属性。要获得计算后样式，需要同时考虑样式表中设置的样式，请使用内置的getComputedStyle方法。
- 要获取HTML元素的尺寸，请使用offsetWidth和offsetHeight属性。
- 当代码对DOM进行一系列连续的读取和写入操作时，浏览器每次都会强制重新计算布局信息，这会引起布局抖动。这进而导致Web应用程序运行和响应速度变慢。
- 请批量更新DOM！


### 4.2 的事件

事件循环任务代表浏览器执行的行为。任务分为以下两类。
- 宏任务是分散的、独立的浏览器操作，如创建主文档对象、处理各种事件、更改URL等。
- 微任务是应该尽快执行的任务。包括promise回调和DOM突变。
- 由于单线程的执行模型，一次只能处理一个任务，一个任务开始执行后不能被另一个任务中断。事件循环通常至少有两个事件队列：宏任务队列和微任务队列。
- 异步定时器提供延迟执行一段代码的能力，至少延迟指定的毫秒数。
- 使用setTimeout函数在指定的延迟时间后执行回调。
- 使用setInterval函数来启动一个计时器，将尝试在指定的延迟间隔执行回调，直至被清除。
- 两个函数均返回对应的计时器ID，通过clearTimeout和clearInterval函数，我们可以使用计时器ID来取消计时器。
- 使用计时器，将计算开销很高的代码分解成可管理的、不阻塞浏览器的代码块。
- DOM是元素的分层树，发生在一个元素（target）上的事件通常是通过DOM进行代理的，有以下两种机制。
- 事件捕获模式：事件从顶部元素向下传递到目标元素。
- 事件冒泡模式：事件从目标元素向上冒泡到顶部元素。
- 当调用事件处理器时，浏览器也会传入一个事件对象。通过该对象的属性可访问发生事件的目标元素。通过处理器，使用this关键字引用在处理器上注册过的元素。
- 通过内置的CustomEvent构造函数和dispatchEvent方法，创建和分发自定义事件，减少应用程序不同部分之间的耦合

### 4.3 跨浏览器

虽然情况有了较大的改善，但是浏览器不可能没有缺陷，并且通常不支持Web标准。
- 当编写JavaScript应用程序时，选择支持的浏览器和平台是一个重要的考虑因素。
- 由于不可能支持所有组合，因此需要以牺牲质量赢取覆盖率。
- 编写可运行于多种浏览器的JavaScript代码，最大的挑战是：缺陷修复、回归、浏览器缺陷、特性缺失以及外部代码。
- 可重用的跨浏览器开发涉及以下几个因素。
 代码体积——保持文件体积尽可能小。
 性能开销——以优秀作为最低性能标准。
 API质量——保证不同浏览器上API一致性。
- 这些因素的权衡没有绝对的计算公式。
- 每位开发人员的个人努力是可用于权衡考虑的因素。
- 通过使用智能技术，如功能检测，当可重用代码受到攻击时，我们可以有效抵御，不需要做任何不必要的牺牲。

